# Rust 製の Web アプリケーション

Rust の使い方全般を実装するためのリポジトリです。

## 試したこと

- Docker を使って Rust の開発環境を構築
- actix-web を使って APIサーバーを実装
- cargo-watch を使ってファイルの変更を検知して自動でビルド
- 開発環境と本番ビルド環境の切り替え（実装途中）
- ルーティング、サービス、コントローラーモデルの実装

## モデル（テーブル）の作成からマイグレーションまで

# migrations dirを作成
  dieselをインストールして以下を実行する
  `diesel setup`
1. マイグレーションファイルの作成:
   `diesel migration generate create_<table_name>` でマイグレーションファイルを作成する。
2. マイグレーションファイルの編集:
   `up.sql` にテーブルの作成、`down.sql` にテーブルの削除を記述する。
3. マイグレーションの実行:
   `diesel migration run` でマイグレーションを実行する。
4. モデルの作成:
   `src/schema.rs` にテーブルの定義を記述する。
   docker-compose exec app diesel print-schema > src/schema.rs
5. モデルの追加:
   `src/models.rs` にテーブルのモデルを追加する。

# プロジェクト構造

このプロジェクトは以下の構造を持っています：

- `migrations/`: データベースの構造を変更するためのファイルを含みます。
- `src/`: アプリケーションのソースコードを含みます。
  - `controllers/`: HTTPリクエストを処理し、適切なレスポンスを返します。
  - `models/`: データの構造を定義します。
  - `services/`: ビジネスロジックを実装します。
  - `repositories/`: データベースとのやり取りを担当します。
  - `db.rs`: データベース接続の設定を管理します。
  - `routes.rs`: APIのルーティングを定義します。
  - `schema.rs`: データベーススキーマの定義を含みます。
  - `main.rs`: アプリケーションのエントリーポイントです。
## 各コンポーネントの役割

1. コントローラー (Controllers):
   - ユーザーからのリクエストを受け取り、適切な処理を行います。
   - サービス層を呼び出して必要な操作を実行します。
   - 処理結果をユーザーに返します。

2. サービス (Services):
   - アプリケーションの主要な機能やビジネスロジックを実装します。
   - 複数の操作を組み合わせて複雑な処理を行います。
   - データの検証や加工を行います。

3. リポジトリ (Repositories):
   - データベースとの通信を担当します。
   - データの保存、取得、更新、削除などの操作を行います。

4. モデル (Models):
   - アプリケーションで扱うデータの構造を定義します。
   - データの検証ルールを定義します。

5. マイグレーション (Migrations):
   - データベースの構造を変更する際に使用します。
   - データベースのバージョン管理を可能にします。

6. データベース設定 (db.rs):
   - データベース接続プールの設定を管理します。
   - アプリケーション全体で使用するデータベース接続を提供します。

7. ルーティング (routes.rs):
   - APIのエンドポイントとそれに対応するコントローラーの関数をマッピングします。
   - URLパスとHTTPメソッドに基づいて、リクエストを適切なコントローラーに転送します。

8. スキーマ定義 (schema.rs):
   - データベースのテーブル構造をRustのコードで表現します。
   - Diesel ORMがこの定義を使用して、データベース操作を型安全に行います。
